#!/usr/bin/env python3
# -*- coding: utf-8 -*-

# jsbuild: Build SpiderMonkey

import argparse
import os.path
import sys

# Import common functions
binDir = os.path.dirname(__file__)
libDir = os.path.join(binDir, '..', 'lib')
sys.path.append(libDir)
from mozutils import *
from mozconfig import *

parser = argparse.ArgumentParser(description = 'Build SpiderMonkey')
parser.add_argument('-n', '--dry-run', action='store_true',
                    help = 'Dry run, check arguments but don\'t build')
add_build_arguments(parser)
add_config_arguments(parser)

args = parser.parse_args()

if not args.unified and not args.sync:
    sys.exit("Disabling of uniifed build only supported with sync")

enter_dirs(args.dirs)

chdir_to_source_root()

if args.remote:
    sys.exit(run_remote_command(args))

if not args.dry_run:
    js_build(args)
